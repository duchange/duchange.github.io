<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è‡³å°Šå¨±ä¹ - æ–—åœ°ä¸»|éº»å°†|çŒœçº¢é»‘|æŠ›ç¡¬å¸ åŒæ¨¡å¼å¹³å°</title>
    <style>
        * {margin: 0;padding: 0;box-sizing: border-box;font-family: "å¾®è½¯é›…é»‘", sans-serif;}
        body {background: linear-gradient(135deg, #090019, #190038, #290058);min-height: 100vh;color: #fff;overflow-x: hidden;}
        /* è‹¹æœå…¼å®¹å¼¹çª— æ›¿æ¢æ‰€æœ‰alert/prompt/confirm */
        #tipsBox {position: fixed;top: 50%;left: 50%;transform: translate(-50%,-50%);padding: 20px 30px;background: #333;color: #fff;border-radius: 8px;font-size: 16px;z-index: 99999;display: none;text-align: center;min-width: 280px;}
        #inputBox {position: fixed;top: 50%;left: 50%;transform: translate(-50%,-50%);padding: 30px;background: linear-gradient(145deg, #121228, #181838);border: 3px solid #ffd700;border-radius: 12px;font-size: 16px;z-index: 99999;display: none;text-align: center;min-width: 300px;}
        #inputBox input {width: 100%;padding:15px;border-radius:8px;border:2px solid #ffd700;background:#090919;color:#fff;margin:15px 0;outline:none;font-size:16px;}
        #inputBox .btn-group {display:flex;justify-content:space-around;margin-top:10px;}
        #confirmBox {position: fixed;top: 50%;left: 50%;transform: translate(-50%,-50%);padding: 30px;background: linear-gradient(145deg, #121228, #181838);border: 3px solid #ffd700;border-radius: 12px;font-size: 16px;z-index: 99999;display: none;text-align: center;min-width: 300px;}
        /* é¡µé¢å®¹å™¨ */
        .login-container {width: 100%;min-height: 100vh;padding: 20px;display: flex;align-items: center;justify-content: center;}
        .game-container {width: 100%;min-height: calc(100vh - 80px);padding: 20px;display: flex;align-items: center;justify-content: center;}
        .card {background: linear-gradient(145deg, #121228, #181838);border-radius: 24px;border: 3px solid #ffd700;box-shadow: 0 0 40px #ffd70070, inset 0 0 25px #ffffff20;backdrop-filter: blur(15px);padding: 35px;margin: 15px;width: 100%;max-width: 1200px;}
        /* æŒ‰é’®æ ·å¼ */
        .btn {background: linear-gradient(90deg, #ffd700, #ff9f00);border: none;border-radius: 12px;padding: 16px 32px;color: #000;font-size: 18px;font-weight: bold;cursor: pointer;margin: 10px;transition: all 0.3s;}
        .btn:hover {transform: scale(1.06);box-shadow: 0 0 25px #ffd700;}
        .btn-danger {background: linear-gradient(90deg, #ff4757, #ff3838);color: #fff;}
        .btn-primary {background: linear-gradient(90deg, #00d2ff, #3a7bd5);color: #fff;}
        .btn-single {background: linear-gradient(90deg, #00ff9d, #00c875);color: #fff;padding:20px 0;font-size:22px;margin:8px 0;width:48%;font-weight: bold;border-radius:12px;}
        .btn-multi {background: linear-gradient(90deg, #7b68ee, #4169e1);color: #fff;padding:20px 0;font-size:22px;margin:8px 0;width:48%;font-weight: bold;border-radius:12px;}
        /* è¾“å…¥æ¡†æ ·å¼ */
        .input {width: 100%;padding: 18px;border-radius: 12px;border: 2px solid #ffd700;background: #090919;color: #fff;font-size: 18px;margin: 12px 0;outline: none;}
        .input:focus {border-color: #ff9f00;box-shadow: 0 0 15px #ff9f0050;}
        /* æ–‡å­—æ ·å¼ */
        .title {text-align: center;font-size: 40px;background: linear-gradient(90deg, #ffd700, #fff);-webkit-background-clip: text;color: transparent;margin: 20px 0;font-weight: bold;text-shadow: 0 0 20px #ffd70050;}
        .sub-title {font-size: 26px;color: #ffd700;margin: 15px 0;text-align: center;}
        .info {font-size: 18px;margin: 10px;color: #ccc;line-height: 1.6;}
        .gold {color: #ffd700;font-weight: bold;}
        .vip {color: #ff4757;font-weight: bold;}
        .code {color: #00d2ff;font-weight: bold;letter-spacing: 2px;}
        /* æ¸¸æˆå¸ƒå±€ */
        .game-grid {display: grid;grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));gap: 20px;margin: 30px 0;width: 100%;}
        .game-item {background: linear-gradient(145deg, #1a1a2e, #16213e);border-radius: 18px;border: 2px solid #ffd700;padding: 28px;text-align: center;cursor: pointer;transition: all 0.3s;}
        .game-item:hover {transform: translateY(-12px);box-shadow: 0 12px 35px #ffd70050;}
        .mode-box {display:flex;justify-content:space-between;align-items:center;width:100%;margin:20px 0;flex-wrap:wrap;}
        .room-box {display: flex;flex-direction: column;align-items: center;margin: 20px 0;width: 100%;}
        /* ç‰Œå‹æ ¸å¿ƒæ ·å¼ - ç‚¹å‡»é€‰ä¸­é«˜äº® */
        .card-item {width: 60px;height: 90px;background: linear-gradient(145deg, #fff, #f0f0f0);border-radius: 8px;border: 1px solid #ccc;margin: 5px;display: inline-flex;justify-content: center;align-items: center;font-size: 20px;font-weight: bold;color: #000;box-shadow: 0 2px 5px #0005;cursor: pointer;transition: all 0.3s;}
        .card-item.selected {border: 3px solid #ffd700;box-shadow: 0 0 15px #ffd700;transform: scale(1.08);}
        .mahjong-item {width: 60px;height: 80px;background: linear-gradient(145deg, #fff, #f9f9f9);border-radius: 5px;border: 1px solid #ccc;margin: 5px;display: inline-flex;justify-content: center;align-items: center;font-size: 18px;font-weight: bold;color: #000;cursor: pointer;transition: all 0.3s;}
        .mahjong-item.selected {border: 3px solid #ffd700;box-shadow: 0 0 15px #ffd700;transform: scale(1.08);}
        .operation-btn {display: flex;flex-wrap: wrap;justify-content: center;margin: 20px 0;width: 100%;}
        /* å……å€¼æ ·å¼ */
        .charge-grid {display: grid;grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));gap: 20px;margin: 20px 0;width: 100%;}
        .charge-item {background: linear-gradient(145deg, #2c3e50, #34495e);border-radius: 15px;border: 2px solid #ffd700;padding: 22px;text-align: center;cursor: pointer;transition: all 0.3s;}
        .charge-item:hover {transform: scale(1.05);box-shadow:0 0 20px #ffd700;}
        /* ä¸ªäººä¸»é¡µ */
        .user-center {display: flex;flex-wrap: wrap;align-items: center;justify-content: space-between;margin-bottom:30px;border-bottom:2px solid #ffd70030;padding-bottom:25px;}
        .user-avatar {width:130px;height:130px;border-radius:50%;background:linear-gradient(145deg,#ffd700,#ff9f00);display:flex;justify-content:center;align-items:center;font-size:60px;margin:10px;box-shadow:0 0 30px #ffd70070;}
        .user-info {flex:1;margin:10px;}
        .user-data {display:grid;grid-template-columns: repeat(auto-fit,minmax(200px,1fr));gap:18px;margin:25px 0;width:100%;}
        .data-item {background:linear-gradient(145deg,#1a1a2e,#16213e);border-radius:12px;padding:20px;border:1px solid #ffd700;}
        .vip-rule {background:#090919;border-radius:12px;padding:22px;margin:20px 0;border:1px solid #ffd700;}
        /* æ¿€æ´»ç æ ·å¼ */
        .code-box {background: linear-gradient(145deg, #00d2ff30, #181838);border:2px solid #00d2ff;border-radius:12px;padding:20px;margin:20px 0;text-align:center;}
        /* åº•éƒ¨å¯¼èˆª */
        .footer-nav {position: fixed;bottom:0;left:0;width:100%;height:80px;background: linear-gradient(145deg, #121228, #090019);border-top:3px solid #ffd700;display:flex;justify-content: space-around;align-items:center;z-index:9999;box-shadow: 0 -5px 30px #ffd70050;}
        .nav-item {width:33.33%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;cursor:pointer;color:#fff;transition:all 0.3s;font-size:14px;}
        .nav-item:hover {color:#ffd700;}
        .nav-item i {font-size:28px;margin-bottom:5px;}
        /* éšè—ç±» */
        .hidden {display: none !important;}
        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 768px) {
            .title {font-size: 28px;}
            .sub-title {font-size: 22px;}
            .btn {padding: 12px 20px;font-size: 16px;}
            .btn-single,.btn-multi {width:100%;font-size:20px;padding:18px 0;}
            .card-item {width: 40px;height: 60px;font-size: 16px;}
            .mahjong-item {width: 40px;height: 60px;font-size: 14px;}
            .user-avatar {width:90px;height:90px;font-size:40px;}
            .charge-grid {grid-template-columns: repeat(auto-fit,minmax(140px,1fr));}
            .footer-nav {height:70px;}
            .nav-item i {font-size:24px;}
            .game-container {min-height: calc(100vh - 70px);}
        }
        @media (max-width: 480px) {
            .game-container {padding: 10px;}
            .card {padding: 20px;}
            .title {font-size: 24px;}
        }
    </style>
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- è‹¹æœå…¼å®¹å¼¹çª—ç»„ä»¶ -->
    <div id="tipsBox"></div>
    <div id="inputBox">
        <p id="inputText">è¯·è¾“å…¥æœ¬å±€æŠ¼æ³¨é‡‘å¸æ•°ï¼ˆâ‰¥100ï¼‰</p>
        <input type="number" id="inputVal" value="100" min="100">
        <div class="btn-group">
            <button class="btn" style="padding:8px 16px;" onclick="confirmInput()">ç¡®è®¤</button>
            <button class="btn btn-danger" style="padding:8px 16px;" onclick="cancelInput()">å–æ¶ˆ</button>
        </div>
    </div>
    <div id="confirmBox">
        <p id="confirmText">ç¡®å®šè®¤è¾“ï¼Ÿå°†æ‰£é™¤æŠ¼æ³¨é‡‘å¸</p>
        <div class="btn-group">
            <button class="btn" style="padding:8px 16px;" onclick="confirmOk()">ç¡®å®š</button>
            <button class="btn btn-danger" style="padding:8px 16px;" onclick="confirmNo()">å–æ¶ˆ</button>
        </div>
    </div>
    <!-- æ³¨å†Œé¡µé¢ -->
    <div id="register-page" class="login-container">
        <div class="card">
            <h2 class="title">è‡³å°Šå¨±ä¹ âœ¦ è´¦å·æ³¨å†Œ</h2>
            <input type="text" id="reg-name" class="input" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" required>
            <input type="password" id="reg-pwd" class="input" placeholder="è¯·è¾“å…¥ç™»å½•å¯†ç ï¼ˆ6ä½åŠä»¥ä¸Šï¼‰" required>
            <input type="text" id="reg-code" class="input" placeholder="è¯·è¾“å…¥æ¿€æ´»ç " required>
            <div class="code-box"><span class="info">è¯·åŠ QQè·å–æœ€æ–°æ¿€æ´»ç </span></span><span class="code">3675315307</span></div>
            <button class="btn" onclick="register()">å®Œæˆæ³¨å†Œ</button>
            <p class="info" style="text-align: center;margin-top: 20px;">å·²æœ‰è´¦å·ï¼Ÿ<span style="color:#ffd700;cursor:pointer;" onclick="showLogin()">ç«‹å³ç™»å½•</span></p>
        </div>
    </div>
    <!-- ç™»å½•é¡µé¢ -->
    <div id="login-page" class="login-container hidden">
        <div class="card">
            <h2 class="title">è‡³å°Šå¨±ä¹ âœ¦ è´¦å·ç™»å½•</h2>
            <input type="text" id="login-name" class="input" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" required>
            <input type="password" id="login-pwd" class="input" placeholder="è¯·è¾“å…¥ç™»å½•å¯†ç " required>
            <button class="btn" onclick="login()">ç«‹å³ç™»å½•</button>
            <p class="info" style="text-align: center;margin-top: 20px;">æš‚æ— è´¦å·ï¼Ÿ<span style="color:#ffd700;cursor:pointer;" onclick="showRegister()">ç‚¹å‡»æ³¨å†Œ</span></p>
        </div>
    </div>
    <!-- æ¸¸æˆä¸»é¡µ -->
    <div id="main-page" class="game-container hidden">
        <div class="card">
            <div style="display: flex;justify-content: space-between;align-items: center;margin-bottom: 30px;flex-wrap: wrap;">
                <div>
                    <p class="info">æ˜µç§°ï¼š<span id="user-name" class="gold"></span></p>
                    <p class="info">é‡‘å¸ï¼š<span id="user-gold" class="gold"></span></p>
                    <p class="info">VIPç­‰çº§ï¼š<span id="user-vip" class="vip"></span></p>
                </div>
                <button class="btn btn-danger" onclick="logout()">é€€å‡ºç™»å½•</button>
            </div>
            <h2 class="title">ğŸ® æ¸¸æˆå¤§å…</h2>
            <div class="game-grid">
                <div class="game-item" onclick="showGameMode('doudizhu')">
                    <div style="font-size: 40px;">â™ ï¸</div>
                    <h3>æ–—åœ°ä¸»</h3>
                    <p class="info">é€‰ç‰Œå‡ºç‰Œ | ç‰Œå‹æ ¡éªŒ | è¾“èµ¢æ‰£é‡‘å¸</p>
                </div>
                <div class="game-item" onclick="showGameMode('majiang')">
                    <div style="font-size: 40px;">ğŸ€„ï¸</div>
                    <h3>éº»å°†</h3>
                    <p class="info">é€‰ç‰Œç¢°æ  | èƒ¡ç‰Œèµ¢é‡‘å¸</p>
                </div>
                <div class="game-item" onclick="showGameMode('caihonghei')">
                    <div style="font-size: 40px;">â¤ï¸âš«</div>
                    <h3>çŒœçº¢é»‘</h3>
                    <p class="info">æŠ¼æ³¨å¼€å¥– | çŒœé”™æ‰£é‡‘å¸</p>
                </div>
                <div class="game-item" onclick="showGameMode('coin')">
                    <div style="font-size: 40px;">ğŸª™</div>
                    <h3>æŠ›ç¡¬å¸</h3>
                    <p class="info">æ­£åæŠ¼æ³¨ | çŒœé”™æ‰£é‡‘å¸</p>
                </div>
            </div>
        </div>
    </div>
    <!-- æ¸¸æˆæ¨¡å¼é€‰æ‹©é¡µ -->
    <div id="mode-page" class="game-container hidden">
        <div class="card">
            <h2 class="title" id="mode-title">æ–—åœ°ä¸» âœ¦ ç©æ³•é€‰æ‹©</h2>
            <div class="mode-box">
                <button class="btn-single" onclick="showInputBox()">å•äººåŒ¹é…</button>
                <button class="btn-multi" onclick="startMultiGame()"><i class="fas fa-users"></i> å¤šäººè”æœº</button>
            </div>
            <p class="info" style="text-align:center;">å•äººåŒ¹é…ï¼šä¸€é”®å¼€å±€ï¼ŒNPCæ™ºèƒ½é™ªç©<br>å¤šäººè”æœºï¼šåˆ›å»º/åŠ å…¥æˆ¿é—´ï¼Œå¥½å‹åŒå°ç«æŠ€</p>
            <button class="btn btn-danger" style="width:100%;margin-top:20px;" onclick="showMain()">è¿”å›å¤§å…</button>
        </div>
    </div>
    <!-- å¤šäººè”æœºæˆ¿é—´é¡µ -->
    <div id="room-page" class="game-container hidden">
        <div class="card">
            <h2 class="title" id="game-title"></h2>
            <div class="room-box">
                <p class="info">å½“å‰é‡‘å¸ï¼š<span id="room-gold" class="gold"></span></p>
                <input type="number" id="bet-num" class="input" placeholder="è¯·è¾“å…¥æŠ¼æ³¨é‡‘å¸æ•°ï¼ˆâ‰¥100ï¼‰" min="100" required>
                <input type="text" id="room-id" class="input" placeholder="è¯·è¾“å…¥æˆ¿é—´å·åŠ å…¥">
                <button class="btn" onclick="createRoom()">åˆ›å»ºæˆ¿é—´</button>
                <button class="btn btn-primary" onclick="joinRoom()">åŠ å…¥æˆ¿é—´</button>
                <button class="btn btn-danger" onclick="showGameMode(currentGame)">è¿”å›æ¨¡å¼é€‰æ‹©</button>
            </div>
        </div>
    </div>
    <!-- æ¸¸æˆå¯¹å±€é¡µ -->
    <div id="play-page" class="game-container hidden">
        <div class="card">
            <h2 class="title" id="play-game-title"></h2>
            <p class="info">æŠ¼æ³¨é‡‘å¸ï¼š<span id="play-bet" class="gold"></span></p>
            <p class="info">ç©å®¶åˆ—è¡¨ï¼š<span id="player-list" class="gold"></span></p>
            <div id="game-content" style="margin: 30px 0;text-align: center;width: 100%;"></div>
            <div class="operation-btn" id="game-operation"></div>
            <button class="btn btn-danger" onclick="exitGame()">é€€å‡ºæ¸¸æˆ</button>
        </div>
    </div>
    <!-- æˆ‘çš„ä¸»é¡µ -->
    <div id="user-center-page" class="game-container hidden">
        <div class="card">
            <h2 class="title">ğŸ‘¤ æˆ‘çš„ä¸»é¡µ</h2>
            <div class="user-center">
                <div class="user-avatar">ğŸ‘‘</div>
                <div class="user-info">
                    <h3 style="font-size:28px;color:#ffd700;" id="uc-name">æ˜µç§°</h3>
                    <p class="info">VIPç­‰çº§ï¼š<span id="uc-vip" class="vip">V0</span></p>
                    <p class="info">è´¦å·çŠ¶æ€ï¼š<span style="color:#00d2ff;">æ­£å¸¸âœ…</span></p>
                </div>
            </div>
            <div class="user-data">
                <div class="data-item">
                    <p class="info">å½“å‰é‡‘å¸</p>
                    <p style="font-size:24px;" id="uc-gold" class="gold">0</p>
                </div>
                <div class="data-item">
                    <p class="info">ç´¯è®¡å……å€¼</p>
                    <p style="font-size:24px;" id="uc-total" class="gold">0</p>
                </div>
                <div class="data-item">
                    <p class="info">å½“å‰èƒœç‡</p>
                    <p style="font-size:24px;color:#00d2ff;">68%</p>
                </div>
            </div>
            <div class="vip-rule">
                <h3 class="sub-title" style="font-size:20px;">ğŸ« VIPç­‰çº§è§„åˆ™</h3>
                <p class="info">6000ç´¯è®¡=V1 | 30000ç´¯è®¡=V2 | 48888ç´¯è®¡=V3 | 59888ç´¯è®¡=V4</p>
                <p class="info">64800ç´¯è®¡=V5 | 78888ç´¯è®¡=V6 | 88888ç´¯è®¡=V7 | 90000ç´¯è®¡=V8</p>
                <p class="info">91780ç´¯è®¡=V9 | 100000ç´¯è®¡=V10</p>
            </div>
        </div>
    </div>
    <!-- å……å€¼ä¸­å¿ƒ -->
    <div id="charge-page" class="game-container hidden">
        <div class="card">
            <h2 class="title">ğŸ’ å……å€¼ä¸­å¿ƒï¼ˆå…è´¹é¢†å–ï¼‰</h2>
            <p class="info">å½“å‰é‡‘å¸ï¼š<span id="charge-gold" class="gold"></span></p>
            <p class="info">å½“å‰VIPï¼š<span id="charge-vip" class="vip"></span> | ç´¯è®¡å……å€¼ï¼š<span id="charge-total" class="gold"></span></p>
            <div class="charge-grid">
                <div class="charge-item" onclick="chargeGold(6000)">6000é‡‘å¸</div>
                <div class="charge-item" onclick="chargeGold(12800)">12800é‡‘å¸</div>
                <div class="charge-item" onclick="chargeGold(28800)">28800é‡‘å¸</div>
                <div class="charge-item" onclick="chargeGold(32800)">32800é‡‘å¸</div>
                <div class="charge-item" onclick="chargeGold(45800)">45800é‡‘å¸</div>
                <div class="charge-item" onclick="chargeGold(64800)">64800é‡‘å¸</div>
            </div>
        </div>
    </div>
    <!-- åº•éƒ¨å¯¼èˆª -->
    <div class="footer-nav hidden" id="footer-nav">
        <div class="nav-item" onclick="showMain()"><i class="fas fa-gamepad"></i><br>æ¸¸æˆä¸»é¡µ</div>
        <div class="nav-item" onclick="showUserCenter()"><i class="fas fa-user-circle"></i><br>æˆ‘çš„ä¸»é¡µ</div>
        <div class="nav-item" onclick="showCharge()"><i class="fas fa-diamond"></i><br>å……å€¼ä¸­å¿ƒ</div>
    </div>
    <script>
        // å…¨å±€æ•°æ®
        let userData = {name: "", pwd: "", gold: 10000, vip: 0, totalGold: 10000};
        let currentGame = "";
        let currentBet = 0;
        let playerList = [];
        // æ–°å¢ï¼šNPCæ‰‹ç‰Œæ•°æ®
        let npc1Poker = [], npc2Poker = [];
        // ç‰Œåº“æ•°æ®
        const pokerLib = ['Aâ™ ','2â™ ','3â™ ','4â™ ','5â™ ','6â™ ','7â™ ','8â™ ','9â™ ','10â™ ','Jâ™ ','Qâ™ ','Kâ™ ',
                           'Aâ™¥','2â™¥','3â™¥','4â™¥','5â™¥','6â™¥','7â™¥','8â™¥','9â™¥','10â™¥','Jâ™¥','Qâ™¥','Kâ™¥',
                           'Aâ™£','2â™£','3â™£','4â™£','5â™£','6â™£','7â™£','8â™£','9â™£','10â™£','Jâ™£','Qâ™£','Kâ™£',
                           'Aâ™¦','2â™¦','3â™¦','4â™¦','5â™¦','6â™¦','7â™¦','8â™¦','9â™¦','10â™¦','Jâ™¦','Qâ™¦','Kâ™¦',
                           'å¤§ç‹','å°ç‹'];
        const mahjongLib = ['1ç­’','2ç­’','3ç­’','4ç­’','5ç­’','6ç­’','7ç­’','8ç­’','9ç­’',
                             '1æ¡','2æ¡','3æ¡','4æ¡','5æ¡','6æ¡','7æ¡','8æ¡','9æ¡',
                             '1ä¸‡','2ä¸‡','3ä¸‡','4ä¸‡','5ä¸‡','6ä¸‡','7ä¸‡','8ä¸‡','9ä¸‡',
                             'ä¸œé£','è¥¿é£','å—é£','åŒ—é£','çº¢ä¸­','å‘è´¢','ç™½æ¿'];
        let userPoker = [];
        let userMahjong = [];
        let lastOutPoker = {type: "", value: [], desc: ""};
        // ========== è‹¹æœå…¼å®¹å¼¹çª—æ–¹æ³• ==========
        function showTips(text) {
            const box = document.getElementById('tipsBox');
            box.innerHTML = text;
            box.style.display = 'block';
            setTimeout(() => box.style.display = 'none', 2000);
        }
        function showInputBox() {
            document.getElementById('inputBox').style.display = 'block';
            document.getElementById('inputVal').focus();
        }
        function confirmInput() {
            currentBet = parseInt(document.getElementById('inputVal').value);
            if(isNaN(currentBet) || currentBet <100 || currentBet > userData.gold){
                showTips('æŠ¼æ³¨é‡‘é¢æ— æ•ˆï¼é‡‘å¸ä¸è¶³');
            }else{
                playerList = [userData.name, "NPC-é™ªç©â‘ ", "NPC-é™ªç©â‘¡"];
                userData.gold -= currentBet;
                saveUserData();
                startGame();
            }
            document.getElementById('inputBox').style.display = 'none';
        }
        function cancelInput() {document.getElementById('inputBox').style.display = 'none';}
        function showConfirmBox(text) {
            document.getElementById('confirmText').innerText = text;
            document.getElementById('confirmBox').style.display = 'block';
        }
        function confirmOk() {
            userData.gold -= currentBet;
            saveUserData();
            updateUserInfo();
            showTips(`âŒ æ¸¸æˆå¤±è´¥ï¼æ‰£é™¤${currentBet}é‡‘å¸ï¼Œå½“å‰é‡‘å¸ï¼š${userData.gold}`);
            exitGame();
            document.getElementById('confirmBox').style.display = 'none';
        }
        function confirmNo() {document.getElementById('confirmBox').style.display = 'none';}
        // ========== é¡µé¢åˆ‡æ¢ ==========
        function showRegister() {
            hideAllPages();
            document.getElementById('register-page').classList.remove('hidden');
            document.getElementById('footer-nav').classList.add('hidden');
        }
        function showLogin() {
            hideAllPages();
            document.getElementById('login-page').classList.remove('hidden');
            document.getElementById('footer-nav').classList.add('hidden');
        }
        function showMain() {
            hideAllPages();
            document.getElementById('main-page').classList.remove('hidden');
            document.getElementById('footer-nav').classList.remove('hidden');
        }
        function showGameMode(game) {
            currentGame = game;
            hideAllPages();
            document.getElementById('mode-page').classList.remove('hidden');
            document.getElementById('footer-nav').classList.remove('hidden');
            let gameName = game === 'doudizhu' ? 'æ–—åœ°ä¸»' : game === 'majiang' ? 'éº»å°†' : game === 'caihonghei' ? 'çŒœçº¢é»‘' : 'æŠ›ç¡¬å¸';
            document.getElementById('mode-title').innerText = `${gameName} âœ¦ ç©æ³•é€‰æ‹©`;
        }
        function startMultiGame() {
            hideAllPages();
            document.getElementById('room-page').classList.remove('hidden');
            document.getElementById('footer-nav').classList.remove('hidden');
            let gameName = currentGame === 'doudizhu' ? 'æ–—åœ°ä¸»' : currentGame === 'majiang' ? 'éº»å°†' : currentGame === 'caihonghei' ? 'çŒœçº¢é»‘' : 'æŠ›ç¡¬å¸';
            document.getElementById('game-title').innerText = `${gameName} âœ¦ å¤šäººè”æœº`;
            document.getElementById('room-gold').innerText = userData.gold;
        }
        function startGame() {
            hideAllPages();
            document.getElementById('play-page').classList.remove('hidden');
            document.getElementById('footer-nav').classList.remove('hidden');
            let gameName = currentGame === 'doudizhu' ? 'æ–—åœ°ä¸»' : currentGame === 'majiang' ? 'éº»å°†' : currentGame === 'caihonghei' ? 'çŒœçº¢é»‘' : 'æŠ›ç¡¬å¸';
            document.getElementById('play-game-title').innerText = `${gameName} âœ¦ æ¸¸æˆå¯¹å±€`;
            document.getElementById('play-bet').innerText = currentBet;
            document.getElementById('player-list').innerText = playerList.join(' | ');
            initGameContent();
        }
        function showUserCenter() {
            hideAllPages();
            document.getElementById('user-center-page').classList.remove('hidden');
            document.getElementById('footer-nav').classList.remove('hidden');
            document.getElementById('uc-name').innerText = userData.name;
            document.getElementById('uc-vip').innerText = `V${userData.vip}`;
            document.getElementById('uc-gold').innerText = userData.gold;
            document.getElementById('uc-total').innerText = userData.totalGold;
        }
        function showCharge() {
            hideAllPages();
            document.getElementById('charge-page').classList.remove('hidden');
            document.getElementById('footer-nav').classList.remove('hidden');
            document.getElementById('charge-gold').innerText = userData.gold;
            document.getElementById('charge-vip').innerText = `V${userData.vip}`;
            document.getElementById('charge-total').innerText = userData.totalGold;
        }
        function hideAllPages() {
            const pages = ['register-page','login-page','main-page','mode-page','room-page','play-page','user-center-page','charge-page'];
            pages.forEach(page => document.getElementById(page).classList.add('hidden'));
        }
        // ========== è´¦å·æ ¸å¿ƒ ==========
        function register() {
            const name = document.getElementById('reg-name').value.trim();
            const pwd = document.getElementById('reg-pwd').value.trim();
            const code = document.getElementById('reg-code').value.trim();
            if(!name) return showTips('è¯·è¾“å…¥ç”¨æˆ·åï¼');
            if(pwd.length <6) return showTips('å¯†ç å¿…é¡»6ä½åŠä»¥ä¸Šï¼');
            if(code !== 'ylm890kz') return showTips('æ¿€æ´»ç é”™è¯¯ï¼');
            if(localStorage.getItem(`user_${name}`)) return showTips('ç”¨æˆ·åå·²å­˜åœ¨ï¼');
            
            userData = {name, pwd, gold: 10000, vip: 0, totalGold: 10000};
            saveUserData();
            updateUserInfo();
            showMain();
            showTips(`æ³¨å†ŒæˆåŠŸï¼åˆå§‹é‡‘å¸10000`);
        }
        function login() {
            const name = document.getElementById('login-name').value.trim();
            const pwd = document.getElementById('login-pwd').value.trim();
            if(!name || !pwd) return showTips('ç”¨æˆ·å/å¯†ç ä¸èƒ½ä¸ºç©ºï¼');
            
            const localData = localStorage.getItem(`user_${name}`);
            if(!localData) return showTips('è´¦å·ä¸å­˜åœ¨ï¼');
            
            userData = JSON.parse(localData);
            if(userData.pwd !== pwd) return showTips('å¯†ç é”™è¯¯ï¼');
            
            updateUserInfo();
            showMain();
            showTips(`ç™»å½•æˆåŠŸï¼æ¬¢è¿å›æ¥ï¼Œ${userData.name}`);
        }
        function logout() {showLogin();showTips('å·²å®‰å…¨é€€å‡ºç™»å½•');}
        function saveUserData() {
            localStorage.setItem(`user_${userData.name}`, JSON.stringify(userData));
            localStorage.setItem('currentUser', userData.name);
        }
        function updateUserInfo() {
            document.getElementById('user-name').innerText = userData.name;
            document.getElementById('user-gold').innerText = userData.gold;
            document.getElementById('user-vip').innerText = `V${userData.vip}`;
            calcVIP();
        }
        function calcVIP() {
            userData.vip = userData.totalGold >=100000 ?10 : userData.totalGold>=91780?9 : userData.totalGold>=90000?8 : userData.totalGold>=88888?7 : userData.totalGold>=78888?6 : userData.totalGold>=64800?5 : userData.totalGold>=59888?4 : userData.totalGold>=48888?3 : userData.totalGold>=30000?2 : userData.totalGold>=6000?1 :0;
            saveUserData();
        }
        function chargeGold(num) {
            userData.gold += num;
            userData.totalGold += num;
            calcVIP();
            saveUserData();
            updateUserInfo();
            showCharge();
            showTips(`âœ… å……å€¼æˆåŠŸï¼è·å¾—${num}é‡‘å¸`);
        }
        // ========== æ–—åœ°ä¸»æ ¸å¿ƒã€ç§»é™¤æ‘¸ç‰Œ+ç‚¹å‡»é€‰ç‰Œ+å‡ºç‰Œæ ¡éªŒ + æ–°å¢NPCè‡ªåŠ¨å‡ºç‰Œã€‘ ==========
        function togglePokerSelect(e) {e.target.classList.toggle('selected');}
        function getRandomArr(arr, num) {
            let newArr = [...arr], res = [];
            for(let i=0;i<num;i++){
                let idx = Math.floor(Math.random() * newArr.length);
                res.push(newArr[idx]);
                newArr.splice(idx,1);
            }
            return res;
        }
        // æ–—åœ°ä¸»ç‰Œå‹åˆæ³•æ€§æ ¡éªŒ
        function checkPokerValid(selectedCards) {
            if (selectedCards.length === 0) return {valid: false, msg: 'è¯·é€‰æ‹©è¦å‡ºçš„ç‰Œ'};
            const values = selectedCards.map(card => card.split('')[0]);
            const uniqueValues = [...new Set(values)];
            // å•å¼ 
            if (selectedCards.length === 1) return {valid: true, type: 'single', desc: 'å•å¼ '};
            // å¯¹å­
            if (selectedCards.length === 2 && uniqueValues.length === 1) return {valid: true, type: 'pair', desc: 'å¯¹å­'};
            // ä¸‰å¼ 
            if (selectedCards.length === 3 && uniqueValues.length === 1) return {valid: true, type: 'triple', desc: 'ä¸‰å¼ '};
            // ç‚¸å¼¹
            if (selectedCards.length === 4 && uniqueValues.length === 1) return {valid: true, type: 'bomb', desc: 'ç‚¸å¼¹'};
            // ç‹ç‚¸
            if (selectedCards.length === 2 && selectedCards.includes('å¤§ç‹') && selectedCards.includes('å°ç‹')) return {valid: true, type: 'rocket', desc: 'ç‹ç‚¸'};
            // é¡ºå­æ ¡éªŒ
            if (selectedCards.length >=5 && selectedCards.length <=12) {
                const order = ['3','4','5','6','7','8','9','10','J','Q','K','A','2'];
                const cardValues = selectedCards.map(card => {
                    const val = card.split('')[0];
                    return order.includes(val) ? val : null;
                }).filter(v => v!==null);
                if (cardValues.length !== selectedCards.length) return {valid: false, msg: 'é¡ºå­ä¸èƒ½åŒ…å«ç‹å’Œ2'};
                const indexes = cardValues.map(v => order.indexOf(v)).sort((a,b) => a-b);
                for (let i=0; i<indexes.length-1; i++) {
                    if (indexes[i+1] - indexes[i] !== 1) return {valid: false, msg: 'é¡ºå­ç‰Œå‹ä¸è¿ç»­'};
                }
                return {valid: true, type: 'straight', desc: 'é¡ºå­'};
            }
            return {valid: false, msg: 'ç‰Œå‹ä¸åˆæ³•ï¼Œè¯·é‡æ–°é€‰æ‹©'};
        }
        // æ–—åœ°ä¸»å‡ºç‰Œ + è§¦å‘NPCè‡ªåŠ¨å‡ºç‰Œ
        function playPoker() {
            const selectedCards = Array.from(document.querySelectorAll('.card-item.selected')).map(el => el.innerText);
            const checkResult = checkPokerValid(selectedCards);
            if (!checkResult.valid) return showTips(checkResult.msg);
            // è·Ÿç‰Œè§„åˆ™æ ¡éªŒ
            if (lastOutPoker.type && checkResult.type !== 'bomb' && checkResult.type !== 'rocket') {
                if (checkResult.type !== lastOutPoker.type) return showTips(`éœ€å‡ºã€${lastOutPoker.desc}ã€‘ç±»å‹çš„ç‰Œ`);
                if (selectedCards.length !== lastOutPoker.value.length) return showTips(`éœ€å‡º${lastOutPoker.value.length}å¼ ç‰Œ`);
            }
            // ç§»é™¤å‡ºç‰Œå¹¶æ›´æ–°æ‰‹ç‰Œ
            selectedCards.forEach(card => {
                const index = userPoker.indexOf(card);
                if (index > -1) userPoker.splice(index, 1);
            });
            lastOutPoker = {type: checkResult.type, value: selectedCards, desc: checkResult.desc};
            showTips(`âœ… å‡ºç‰ŒæˆåŠŸã€${checkResult.desc}ã€‘ï¼š${selectedCards.join(' ')}`);
            initGameContent();
            // å‡ºå®Œç‰Œåˆ¤å®šèƒœåˆ©
            if(userPoker.length === 0){
                gameWin(3);
                return;
            }
            // ========== æ–°å¢æ ¸å¿ƒï¼šç©å®¶å‡ºç‰Œåï¼ŒNPCä¾æ¬¡è‡ªåŠ¨å‡ºç‰Œ ==========
            setTimeout(() => npcAutoPlay(1), 1200);
        }
        // NPCè‡ªåŠ¨å‡ºç‰Œæ ¸å¿ƒé€»è¾‘ (1=NPC1  2=NPC2)
        function npcAutoPlay(npcType) {
            let npcPoker = npcType ===1 ? npc1Poker : npc2Poker;
            let npcName = npcType ===1 ? "NPC-é™ªç©â‘ " : "NPC-é™ªç©â‘¡";
            if(npcPoker.length === 0){
                showTips(`ğŸ‰ ${npcName}å‡ºå®Œç‰Œè·èƒœï¼`);
                userData.gold -= currentBet;
                saveUserData();
                updateUserInfo();
                exitGame();
                return;
            }
            // NPCæ™ºèƒ½åŒ¹é…ç‰Œå‹ï¼šä¼˜å…ˆå‡ºåŒç±»å‹ã€åŒå¼ æ•°ï¼Œæ— åˆ™å‡ºå•å¼ ï¼Œæœ‰ç‚¸å¼¹ç›´æ¥å‡º
            let outCards = [];
            const checkBomb = npcPoker.filter(c=>{
                const val = c.split('')[0];
                return npcPoker.filter(x=>x.split('')[0]===val).length ===4;
            });
            const checkRocket = npcPoker.includes('å¤§ç‹') && npcPoker.includes('å°ç‹');
            
            // ä¼˜å…ˆçº§1ï¼šç‹ç‚¸é€šåƒ
            if(checkRocket){
                outCards = ['å¤§ç‹','å°ç‹'];
            }
            // ä¼˜å…ˆçº§2ï¼šç‚¸å¼¹å‹åˆ¶
            else if(checkBomb.length>0){
                outCards = [checkBomb[0],checkBomb[1],checkBomb[2],checkBomb[3]];
            }
            // ä¼˜å…ˆçº§3ï¼šåŒ¹é…ä¸Šå®¶ç‰Œå‹ã€å¼ æ•°
            else if(lastOutPoker.type){
                if(lastOutPoker.type === 'single') outCards = [npcPoker[0]];
                else if(lastOutPoker.type === 'pair'){
                    for(let i=0;i<npcPoker.length-1;i++){
                        if(npcPoker[i].split('')[0] === npcPoker[i+1].split('')[0]){
                            outCards = [npcPoker[i],npcPoker[i+1]];
                            break;
                        }
                    }
                }
                else if(lastOutPoker.type === 'triple'){
                    for(let i=0;i<npcPoker.length-2;i++){
                        if(npcPoker[i].split('')[0] === npcPoker[i+1].split('')[0] && npcPoker[i].split('')[0] === npcPoker[i+2].split('')[0]){
                            outCards = [npcPoker[i],npcPoker[i+1],npcPoker[i+2]];
                            break;
                        }
                    }
                }
                // æ— åŒ¹é…ç‰Œå‹ï¼Œé»˜è®¤å‡ºå•å¼ 
                if(outCards.length ===0) outCards = [npcPoker[0]];
            }
            // æ— ä¸Šå®¶å‡ºç‰Œï¼Œé»˜è®¤å‡ºå•å¼ 
            else{
                outCards = [npcPoker[0]];
            }
            // æ ¡éªŒNPCå‡ºç‰Œåˆæ³•æ€§å¹¶ç§»é™¤æ‰‹ç‰Œ
            const check = checkPokerValid(outCards);
            if(check.valid){
                outCards.forEach(card => {
                    const idx = npcPoker.indexOf(card);
                    if(idx>-1) npcPoker.splice(idx,1);
                });
                lastOutPoker = {type:check.type,value:outCards,desc:check.desc};
                showTips(`ğŸ¤– ${npcName}å‡ºç‰Œã€${check.desc}ã€‘ï¼š${outCards.join(' ')}`);
                initGameContent();
                // NPC1å‡ºå®Œ â†’ è°ƒç”¨NPC2å‡ºç‰Œ
                if(npcType ===1 && npc2Poker.length>0){
                    setTimeout(()=>npcAutoPlay(2),1200);
                }
            }
        }
        // ========== éº»å°†æ ¸å¿ƒã€ç‚¹å‡»é€‰ç‰Œ+ç¢°æ æ ¡éªŒã€‘ ==========
        function toggleMahjongSelect(e) {e.target.classList.toggle('selected');}
        // éº»å°†ç¢°ç‰Œæ ¡éªŒ
        function pengMahjong() {
            const selected = Array.from(document.querySelectorAll('.mahjong-item.selected')).map(el => el.innerText);
            if(selected.length !==1) return showTips('ç¢°ç‰Œéœ€é€‰æ‹©1å¼ ç‰Œ');
            const target = selected[0];
            const count = userMahjong.filter(m => m === target).length;
            if(count <3) return showTips(`ç¼ºå°‘${3-count}å¼ ${target}ï¼Œæ— æ³•ç¢°ç‰Œ`);
            // ç§»é™¤ç¢°ç‰Œ
            userMahjong = userMahjong.filter(m => m !== target);
            showTips(`âœ… ç¢°ç‰ŒæˆåŠŸï¼å·²ç§»é™¤3å¼ ${target}`);
            initGameContent();
        }
        // éº»å°†æ ç‰Œæ ¡éªŒ
        function gangMahjong() {
            const selected = Array.from(document.querySelectorAll('.mahjong-item.selected')).map(el => el.innerText);
            if(selected.length !==1) return showTips('æ ç‰Œéœ€é€‰æ‹©1å¼ ç‰Œ');
            const target = selected[0];
            const count = userMahjong.filter(m => m === target).length;
            if(count <4) return showTips(`ç¼ºå°‘${4-count}å¼ ${target}ï¼Œæ— æ³•æ ç‰Œ`);
            // ç§»é™¤æ ç‰Œ
            userMahjong = userMahjong.filter(m => m !== target);
            showTips(`âœ… æ ç‰ŒæˆåŠŸï¼å·²ç§»é™¤4å¼ ${target}ï¼Œé¢å¤–æ‘¸1å¼ ç‰Œ`);
            userMahjong.push(getRandomArr(mahjongLib,1)[0]);
            initGameContent();
        }
        // éº»å°†èƒ¡ç‰Œ
        function huMahjong() {
            showTips(`ğŸ‰ èƒ¡ç‰ŒæˆåŠŸï¼`);
            gameWin(4);
        }
        // ========== é€šç”¨æ¸¸æˆæ–¹æ³• ==========
        function initGameContent() {
            const gameContent = document.getElementById('game-content');
            const gameOper = document.getElementById('game-operation');
            gameContent.innerHTML = "";
            gameOper.innerHTML = "";
            // æ–—åœ°ä¸»åˆå§‹åŒ– - æ–°å¢NPCæ‰‹ç‰Œåˆ†é…
            if(currentGame === 'doudizhu'){
                // å¼€å±€ä¸€æ¬¡æ€§åˆ†é…æ‰‹ç‰Œï¼šç©å®¶17å¼ ã€NPC1 17å¼ ã€NPC2 17å¼ 
                if(userPoker.length ===0 && npc1Poker.length ===0 && npc2Poker.length ===0){
                    const allPoker = getRandomArr(pokerLib,54);
                    userPoker = allPoker.slice(0,17);
                    npc1Poker = allPoker.slice(17,34);
                    npc2Poker = allPoker.slice(34,51);
                }
                let html = "<div><h3 class='sub-title'>â™ ï¸ æ‚¨çš„æ‰‹ç‰Œ</h3>";
                userPoker.forEach(c => html += `<div class="card-item" onclick="togglePokerSelect(event)">${c}</div>`);
                html += `</div><p class="info">å‰©ä½™æ‰‹ç‰Œï¼š${userPoker.length}å¼ </p>`;
                html += `<p class="info">NPCâ‘ æ‰‹ç‰Œï¼š${npc1Poker.length}å¼  | NPCâ‘¡æ‰‹ç‰Œï¼š${npc2Poker.length}å¼ </p>`;
                if(lastOutPoker.value.length>0){
                    html += `<p class="info">ä¸Šè½®å‡ºç‰Œï¼š<span class="gold">${lastOutPoker.value.join(' ')}</span></p>`;
                }
                gameContent.innerHTML = html;
                gameOper.innerHTML = `<button class="btn" onclick="playPoker()">ç¡®è®¤å‡ºç‰Œ</button>
                <button class="btn btn-danger" onclick="showConfirmBox(\`ç¡®å®šè®¤è¾“ï¼Ÿå°†æ‰£é™¤${currentBet}æŠ¼æ³¨é‡‘å¸\`)">è®¤è¾“æ‰£é‡‘å¸</button>`;
            }
            // éº»å°†åˆå§‹åŒ–
            else if(currentGame === 'majiang'){
                userMahjong = userMahjong.length>0 ? userMahjong : getRandomArr(mahjongLib,13);
                let html = "<div><h3 class='sub-title'>ğŸ€„ï¸ æ‚¨çš„æ‰‹ç‰Œ</h3>";
                userMahjong.forEach(m => html += `<div class="mahjong-item" onclick="toggleMahjongSelect(event)">${m}</div>`);
                html += `</div><p class="info">å‰©ä½™æ‰‹ç‰Œï¼š${userMahjong.length}å¼ </p>`;
                gameContent.innerHTML = html;
                gameOper.innerHTML = `<button class="btn" onclick="pengMahjong()">ç¢°ç‰Œ</button>
                <button class="btn" onclick="gangMahjong()">æ ç‰Œ</button>
                <button class="btn" onclick="huMahjong()">èƒ¡ç‰Œé¢†å¥–</button>
                <button class="btn btn-danger" onclick="showConfirmBox(\`ç¡®å®šè®¤è¾“ï¼Ÿå°†æ‰£é™¤${currentBet}æŠ¼æ³¨é‡‘å¸\`)">è®¤è¾“æ‰£é‡‘å¸</button>`;
            }
            // çŒœçº¢é»‘
            else if(currentGame === 'caihonghei'){
                gameContent.innerHTML = `<div style="font-size: 80px;margin:30px 0;">â¤ï¸âš«</div><h3 class='sub-title'>ç‚¹å‡»å¼€å¥–ï¼ŒçŒœé”™å°†æ‰£é™¤${currentBet}é‡‘å¸</h3>`;
                gameOper.innerHTML = `<button class="btn" onclick="guessRedBlack()">ç«‹å³å¼€å¥–</button>`;
            }
            // æŠ›ç¡¬å¸
            else if(currentGame === 'coin'){
                gameContent.innerHTML = `<div style="font-size: 80px;margin:30px 0;">ğŸª™</div><h3 class='sub-title'>ç‚¹å‡»æŠ›å¸ï¼ŒçŒœé”™å°†æ‰£é™¤${currentBet}é‡‘å¸</h3>`;
                gameOper.innerHTML = `<button class="btn" onclick="tossCoin()">æŠ›ç¡¬å¸</button>`;
            }
        }
        // æ¸¸æˆèƒœåˆ©å¥–åŠ±
        function gameWin(multiple) {
            const winGold = currentBet * multiple;
            userData.gold += winGold;
            saveUserData();
            updateUserInfo();
            showTips(`ğŸ‰ æ­å–œè·èƒœï¼èµ¢å–${winGold}é‡‘å¸ï¼Œå½“å‰é‡‘å¸ï¼š${userData.gold}`);
            exitGame();
        }
        // çŒœçº¢é»‘åˆ¤å®š
        function guessRedBlack() {
            const res = Math.random()>0.5 ? 'â¤ï¸çº¢' : 'âš«é»‘';
            document.getElementById('game-content').innerHTML = `<div style="font-size:80px;margin:30px 0;">${res}</div><h3 class='sub-title'>å¼€å¥–ç»“æœï¼š${res}</h3>`;
            if(res === 'â¤ï¸çº¢'){
                userData.gold += currentBet*2;
                saveUserData();
                updateUserInfo();
                showTips(`ğŸ‰ çŒœå¯¹çº¢ï¼èµ¢å–${currentBet*2}é‡‘å¸`);
            }else{
                userData.gold -= currentBet;
                saveUserData();
                updateUserInfo();
                showTips(`âŒ çŒœé”™é»‘ï¼æ‰£é™¤${currentBet}é‡‘å¸`);
            }
        }
        // æŠ›ç¡¬å¸åˆ¤å®š
        function tossCoin() {
            const res = Math.random()>0.5 ? 'æ­£é¢âœ…' : 'åé¢âŒ';
            document.getElementById('game-content').innerHTML = `<div style="font-size:80px;margin:30px 0;">ğŸª™</div><h3 class='sub-title'>ç»“æœï¼š${res}</h3>`;
            if(res === 'æ­£é¢âœ…'){
                userData.gold += currentBet*2

            saveUserData();
            updateUserInfo();
            showTips(`ğŸ‰ çŒœå¯¹æ­£é¢ï¼èµ¢å–${currentBet*2}é‡‘å¸`);
        }else{
            userData.gold -= currentBet;
            saveUserData();
            updateUserInfo();
            showTips(`âŒ çŒœé”™åé¢ï¼æ‰£é™¤${currentBet}é‡‘å¸`);
        }
    }
    // é€€å‡ºæ¸¸æˆè¿”å›å¤§å…
    function exitGame() {
        userPoker = [];
        userMahjong = [];
        npc1Poker = [];
        npc2Poker = [];
        lastOutPoker = {type: "", value: [], desc: ""};
        showMain();
    }
    // å¤šäººè”æœºå ä½æ–¹æ³•
    function createRoom() {
        const bet = parseInt(document.getElementById('bet-num').value);
        if(isNaN(bet) || bet <100 || bet > userData.gold){
            showTips('æŠ¼æ³¨é‡‘é¢æ— æ•ˆï¼Œé‡‘å¸ä¸è¶³ï¼');
            return;
        }
        currentBet = bet;
        userData.gold -= currentBet;
        saveUserData();
        const roomId = Math.floor(Math.random()*1000000);
        showTips(`âœ… åˆ›å»ºæˆ¿é—´æˆåŠŸï¼æˆ¿é—´å·ï¼š${roomId}`);
        document.getElementById('room-id').value = roomId;
    }
    function joinRoom() {
        const roomId = document.getElementById('room-id').value.trim();
        const bet = parseInt(document.getElementById('bet-num').value);
        if(!roomId) return showTips('è¯·è¾“å…¥æˆ¿é—´å·ï¼');
        if(isNaN(bet) || bet <100 || bet > userData.gold) return showTips('æŠ¼æ³¨é‡‘é¢æ— æ•ˆï¼');
        currentBet = bet;
        userData.gold -= currentBet;
        saveUserData();
        playerList = [userData.name, "ç©å®¶2", "ç©å®¶3"];
        startGame();
        showTips(`âœ… åŠ å…¥æˆ¿é—´${roomId}æˆåŠŸï¼`);
    }
    // é¡µé¢åˆå§‹åŒ–åŠ è½½
    window.onload = function() {
        const currentUser = localStorage.getItem('currentUser');
        if(currentUser){
            const localData = localStorage.getItem(`user_${currentUser}`);
            if(localData){
                userData = JSON.parse(localData);
                updateUserInfo();
                showMain();
                return;
            }
        }
        showRegister();
    };
</script>
</body>
</html>